name: Mise √† jour automatique ü§ñ

on:
  push:
    branches:
      - main
    paths:
      - 'cours/**'   # Seulement si on ajoute/supprime un cours
      - 'maj.py'     # Ou si on modifie le script
  workflow_dispatch:   # Bouton "Run workflow" manuel sur GitHub

jobs:
  update-site:
    # √âvite que le robot re-d√©clenche lui-m√™me le workflow √† l'infini
    if: github.actor != 'Robot Drive L1'
    runs-on: ubuntu-latest
    permissions:
      contents: write  # Autorise le robot √† modifier le site

    steps:
      - name: üì• R√©cup√©ration des fichiers
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: üêç Pr√©paration de l'ordinateur virtuel (Python)
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ‚öôÔ∏è Ex√©cution de ton script maj.py
        env:
          # Les identifiants sont stock√©s en s√©curit√© dans :
          # Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret
          DRIVE_LOGIN: ${{ secrets.DRIVE_LOGIN }}
          DRIVE_MDP: ${{ secrets.DRIVE_MDP }}
        run: |
          git config --global user.name "Robot Drive L1"
          git config --global user.email "robot@github.com"
          python maj.py